import React, { useEffect, useRef, useState } from "react";
import PredefinedDateRanges from "../../../../core/common/datePicker";
import Select from "react-select";
import { Link } from "react-router-dom";
import Table from "../../../../core/common/dataTable/index";
import CommonSelect from "../../../../core/common/commonSelect";
import TooltipOption from "../../../../core/common/tooltipOption";

interface Option {
  label: string;
  value: string;
}

interface Exam1 {
  subject: Option | null;
  section: Option | null;
  examDate: Option | null;
  startTime: Option | null;
  endTime: Option | null;
  duration: Option | null;
  roomNo: Option | null;
  maxMarks: Option | null;
  minMarks: Option | null;
  class: string;
  examName: Option | null;
  key: number;
}

const ExamSchedule = () => {
  const [data, setData] = useState<Exam1[]>([]);
  const dropdownMenuRef = useRef<HTMLDivElement | null>(null);
  const [formValues, setFormValues] = useState<Exam1>({
    subject: null,
    examDate: null,
    startTime: null,
    section: null,
    endTime: null,
    duration: null,
    roomNo: null,
    maxMarks: null,
    minMarks: null,
    key: 0,
    examName: null,
    class: "",
  });

  useEffect(() => {
    const savedData = localStorage.getItem("examSchedule");
    if (savedData) {
      setData(JSON.parse(savedData));
    }
  }, []);

  const handleInputChange = (name: string, value: Option | null) => {
    setFormValues((prevValues) => ({
      ...prevValues,
      [name]: value,
    }));
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    const newData = { ...formValues, key: data.length };
    const updatedData = [...data, newData];
    setData(updatedData);
    localStorage.setItem("examSchedule", JSON.stringify(updatedData));

    // Reset form values after adding
    setFormValues({
      subject: null,
      examDate: null,
      startTime: null,
      endTime: null,
      duration: null,
      roomNo: null,
      maxMarks: null,
      minMarks: null,
      examName: null,
      class: "",
      section: null,
      key: updatedData.length,
    });
  };

  const columns = [
    // Define your columns here...
  ];

  return (
    <div>
      <div className="page-wrapper">
        <div className="content">
          {/* Page Header */}
          <div className="d-md-flex d-block align-items-center justify-content-between mb-3">
            {/* Header Content */}
          </div>
          {/* /Page Header */}
          <div className="card">
            <div className="card-body p-0 py-3">
              <Table columns={columns} dataSource={data} Selection={true} />
            </div>
          </div>
          {/* Add Exam Schedule Modal */}
          <div className="modal fade" id="add_exam_schedule">
            <div className="modal-dialog modal-dialog-centered modal-xl">
              <div className="modal-content">
                <form onSubmit={handleSubmit}>
                  <div className="modal-body">
                    {/* Form Fields */}
                  </div>
                  <div className="modal-footer">
                    <Link to="#" className="btn btn-light me-2" data-bs-dismiss="modal">Cancel</Link>
                    <button type="submit" className="btn btn-primary" data-bs-dismiss="modal">Add Exam Schedule</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default ExamSchedule;
